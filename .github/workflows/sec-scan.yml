name: Security scan

on:
  push:
  pull_request:
  workflow_dispatch:
permissions:
  contents : read
  pull-requests : write
concurrency:
  group: security-scan-${{ github.workflow }}-${{ github.head_ref || github.ref_name }}
  cancel-in-progress: true
jobs:
  security-scan:
    runs-on: ubuntu-latest
    steps:
      - uses : actions/checkout@v6
      - uses : gensecaihq/Shai-Hulud-2.0-Detector@v2
        with:
          fail-on-critical: true
          fail-on-high: true
          fail-on-any: false
          scan-lockfiles: true
          scan-node-modules: false
          output-format: json
          working-directory: '.'
